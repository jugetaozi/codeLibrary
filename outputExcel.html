<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <style>
    </style>
</head>
<body>
    <div class="container">
        <div class="row">
            <button type="button" class="btn btn-success" onclick="outputTable()">导出页面Table为Excel</button>
            <button type="button" class="btn btn-success" onclick="outputJSON()">导出json数据为Excel</button>
        </div>
        <table class="table" id="outputTable">
            <thead>
                <tr>
                    <th colspan="4">各地气温表</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th>北京</th>
                    <td>20℃</td>
                    <th>石家庄</th>
                    <td>22℃</td>
                </tr>
                <tr>
                    <th>北京</th>
                    <td>20℃</td>
                    <th>石家庄</th>
                    <td>22℃</td>
                </tr>
                <tr>
                    <th>北京</th>
                    <td>20℃</td>
                    <th>石家庄</th>
                    <td>22℃</td>
                </tr>
            </tbody>
        </table>
        <code>
             "data": [{"name": "美国", "value": 2637}, {"name": "巴西", "value": 226}, {"name": "\u7f51\u7edc\u653b\u51fb", "value": 149}]

        </code>
    </div>
</body>
<script>
    function outputTable() {
        var table=document.querySelector("#outputTable")
        var outerhtml=table.outerHTML;
        var htmlStart="<html>\n                  <head>\n                    <meta charset='utf-8' />\n                    <style>\n                        th{\n                            background-color: gray;\n                            border-right:1px solid black;\n                        }\n                        tr {\n                            border:1px solid black;\n                        }\n                        td{\n                            border-right:border:1px solid black\n                        }\n                    </style>\n                  </head>\n                  <body>"
        var htmlEnd="</body>\n                </html>";
        var tablehtml=(htmlStart+outerhtml+htmlEnd);
        var excelBlob = new Blob([tablehtml], {type: 'application/vnd.ms-excel'});
        var tag=document.createElement("a");
        // console.log(excelBlob)
        tag.href= URL.createObjectURL(excelBlob);
        tag.type='application/vnd.ms-excel';
        tag.download = '表格-table.xls';
        tag.click();
    }
    function outputJSON() {
        var data='["中国":"20℃","美国":"20℃","日本":"20℃", "韩国":"20℃", "新加坡":"20℃", "马来西亚":"20℃"]';
        var outerhtml=table.outerHTML;
        var htmlStart="<html>\n                  <head>\n                    <meta charset='utf-8' />\n                    <style>\n                        th{\n                            background-color: gray;\n                            border-right:1px solid black;\n                        }\n                        tr {\n                            border:1px solid black;\n                        }\n                        td{\n                            border-right:border:1px solid black\n                        }\n                    </style>\n                  </head>\n                  <body>"
        var htmlEnd="</body>\n                </html>";
        var tablehtml=(htmlStart+outerhtml+htmlEnd);
        var excelBlob = new Blob([tablehtml], {type: 'application/vnd.ms-excel'});
        var tag=document.createElement("a");
        // console.log(excelBlob)
        tag.href= URL.createObjectURL(excelBlob);
        tag.type='application/vnd.ms-excel';
        tag.download = '表格-json.xls';
        tag.click();
    }
</script>
</html>